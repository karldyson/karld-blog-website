<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
    <title>Karl&#x27;s Little World - timemachine</title>
    <subtitle>...just stuff I thought I should write down and that might be useful to others...</subtitle>
    <link rel="self" type="application/atom+xml" href="https://karldyson.github.io/karld-blog-website/tags/timemachine/atom.xml"/>
    <link rel="alternate" type="text/html" href="https://karldyson.github.io/karld-blog-website/"/>
    <generator uri="https://www.getzola.org/">Zola</generator>
    <updated>2025-12-18T00:00:00+00:00</updated>
    <id>https://karldyson.github.io/karld-blog-website/tags/timemachine/atom.xml</id>
    <entry xml:lang="en">
        <title>TimeMachine</title>
        <published>2025-12-18T00:00:00+00:00</published>
        <updated>2025-12-18T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://karldyson.github.io/karld-blog-website/posts/timemachine/"/>
        <id>https://karldyson.github.io/karld-blog-website/posts/timemachine/</id>
        
        <content type="html" xml:base="https://karldyson.github.io/karld-blog-website/posts/timemachine/">&lt;h1 id=&quot;introduction&quot;&gt;Introduction&lt;&#x2F;h1&gt;
&lt;p&gt;I have a MacBook and whilst some of the things I care about get dropped in iCloud and magic’d away onto someone else’s computer for safe keeping and sync’ing to my other Apple devices, I like to back it up too. The Synology does (did?) TimeMachine and so the first thing to replace was that.&lt;&#x2F;p&gt;
&lt;p&gt;I googled and read a bunch of articles, and installed samba and avahi-daemon.&lt;&#x2F;p&gt;
&lt;p&gt;I added the following to the bottom of &lt;code&gt;&#x2F;etc&#x2F;samba&#x2F;smb.conf&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;pre class=&quot;z-code&quot;&gt;&lt;code&gt;&lt;span class=&quot;z-text z-plain&quot;&gt;[TimeMachine]
&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-plain&quot;&gt;   comment = Time Machine Backup
&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-plain&quot;&gt;   path = &#x2F;srv&#x2F;timemachine
&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-plain&quot;&gt;   browseable = yes
&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-plain&quot;&gt;   writable = yes
&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-plain&quot;&gt;   valid users = my_username
&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-plain&quot;&gt;   create mask = 0600
&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-plain&quot;&gt;   directory mask = 0700
&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-plain&quot;&gt;   spotlight = yes
&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-plain&quot;&gt;   vfs objects = catia fruit streams_xattr
&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-plain&quot;&gt;   fruit:aapl = yes
&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-plain&quot;&gt;   fruit:time machine = yes
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;…and I set my samba password with &lt;code&gt;sudo smbpasswd -a my_username&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;p&gt;Now, this RPi is in a different VLAN to my main client LAN, and so whilst I’m sure the Mac would spot this in Finder automagically if they were in the same VLAN, or, if I was bouncing mDNS to and from the network services VLAN, &lt;kbd&gt;⌘ Command&lt;&#x2F;kbd&gt; + &lt;kbd&gt;K&lt;&#x2F;kbd&gt;, typing &lt;code&gt;smb:&#x2F;&#x2F;the.fqdn.of.the.rpi&lt;&#x2F;code&gt; into the address bar and hitting Connect worked just fine (after adding the appropriate firewall configuration to permit tcp&#x2F;445 from the Mac to the RPi.&lt;&#x2F;p&gt;
&lt;p&gt;I authenticated and then opened the TimeMachine control panel. The rest worked just as you’d expect, and a backup kicked off soon after.&lt;&#x2F;p&gt;
&lt;h1 id=&quot;the-srx-config&quot;&gt;…the SRX config…&lt;&#x2F;h1&gt;
&lt;p&gt;Just in case you’re wondering; this is the slightly redacted config for the SRX…&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;Junos&quot; class=&quot;language-Junos z-code&quot;&gt;&lt;code class=&quot;language-Junos&quot; data-lang=&quot;Junos&quot;&gt;&lt;span class=&quot;z-text z-junos&quot;&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-junos&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-junos&quot;&gt;#&lt;&#x2F;span&gt; edit security policies from-zone &amp;lt;zone where Mac lives&amp;gt; to-zone &amp;lt;zone where RPi lives&amp;gt;;
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-junos&quot;&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-junos&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-junos&quot;&gt;#&lt;&#x2F;span&gt; show policy timemachine
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-junos&quot;&gt;match {
&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-junos&quot;&gt;    source-address timemachine-clients;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-junos&quot;&gt;    destination-address timemachine-servers;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-junos&quot;&gt;    application&lt;span class=&quot;z-variable z-language z-junos&quot;&gt; timemachine&lt;&#x2F;span&gt;;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-junos&quot;&gt;}
&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-junos&quot;&gt;then {
&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-junos&quot;&gt;    &lt;span class=&quot;z-constant z-language z-junos&quot;&gt;permit&lt;&#x2F;span&gt;;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-junos&quot;&gt;}
&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-junos&quot;&gt;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-junos&quot;&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-junos&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-junos&quot;&gt;#&lt;&#x2F;span&gt; top
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-junos&quot;&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-junos&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-junos&quot;&gt;#&lt;&#x2F;span&gt; show applications application-set timemachine
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-junos&quot;&gt;application tcp-445;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-junos&quot;&gt;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-junos&quot;&gt;&lt;span class=&quot;z-comment z-line z-number-sign z-junos&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-comment z-junos&quot;&gt;#&lt;&#x2F;span&gt; show applications application tcp-445
&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-junos&quot;&gt;protocol tcp;
&lt;&#x2F;span&gt;&lt;span class=&quot;z-text z-junos&quot;&gt;destination-port &lt;span class=&quot;z-constant z-numeric z-integer z-long z-octal z-junos&quot;&gt;445&lt;&#x2F;span&gt;;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</content>
        
    </entry>
</feed>
