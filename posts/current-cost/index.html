<!doctype html><html lang=en xmlns=http://www.w3.org/1999/xhtml><head><meta charset=UTF-8><meta content="...just stuff I thought I should write down and that might be useful to others..." name=description><meta content="width=device-width,initial-scale=1" name=viewport><meta content=#ff7800 name=theme-color><meta content=#ffa348 media=(prefers-color-scheme:dark) name=theme-color><title>CurrentCost Electricity Monitoring - Karl's Little World</title><link href=https://karldyson.github.io/karld-blog-website/posts/current-cost/ rel=canonical><link href=https://mastodon.social/@karldyson rel=me><meta content=@karldyson@mastodon.social name=fediverse:creator><link href=https://karldyson.github.io/karld-blog-website/favicon.png rel=icon type=image/png><link href=https://karldyson.github.io/karld-blog-website/apple-touch-icon.png rel=apple-touch-icon sizes=180x180 type=image/png><link title="Karl's Little World - Atom Feed" href=https://karldyson.github.io/karld-blog-website/atom.xml rel=alternate type=application/atom+xml><link title="Karl's Little World - RSS Feed" href=https://karldyson.github.io/karld-blog-website/rss.xml rel=alternate type=application/rss+xml><style>:root{--accent-color:#ff7800}[data-theme=dark]{--accent-color:#ffa348}@media (prefers-color-scheme:dark){:root:not([data-theme=light]){--accent-color:#ffa348}}</style><link href=https://karldyson.github.io/karld-blog-website/style.css rel=stylesheet><link media="(prefers-color-scheme: light)" href=https://karldyson.github.io/karld-blog-website/syntax-theme-light.css rel=stylesheet><link media="(prefers-color-scheme: dark)" href=https://karldyson.github.io/karld-blog-website/syntax-theme-dark.css rel=stylesheet><script defer src=https://karldyson.github.io/karld-blog-website/closable.js></script><script data-goatcounter=https://junesta.goatcounter.com/count defer src=https://karldyson.github.io/karld-blog-website/count.js></script><script defer src=https://karldyson.github.io/karld-blog-website/fuse.js></script><script defer src=https://karldyson.github.io/karld-blog-website/search-fuse.js></script><script defer src=https://karldyson.github.io/karld-blog-website/theme-switcher.js></script><meta content="Karl's Little World" property=og:site_name><meta content="CurrentCost Electricity Monitoring - Karl's Little World" property=og:title><meta content=https://karldyson.github.io/karld-blog-website/posts/current-cost/ property=og:url><meta content="How to do cost effective electricity usage monitoring from CurrentCost devices" property=og:description><meta content=https://karldyson.github.io/karld-blog-website/card.png property=og:image><meta content=en_US property=og:locale><body><header id=site-nav><nav><a href=#main-content tabindex=0> Skip to Main Content </a><ul><li id=home><a href=https://karldyson.github.io/karld-blog-website> <i class=icon></i>Karl's Little World</a><li class=divider><li><a href=https://karldyson.github.io/karld-blog-website/about/>About</a><li><a href=https://karldyson.github.io/karld-blog-website/posts/>Posts</a><li id=search><button class=circle id=search-toggle title=Search><i class=icon></i></button><li id=theme-switcher><details class=closable><summary class=circle title=Theme><i class=icon></i></summary> <ul><li><button title="Switch to Light Theme" class=circle id=theme-light><i class=icon></i></button><li><button title="Switch to Dark Theme" class=circle id=theme-dark><i class=icon></i></button><li><button title="Use System Theme" class=circle id=theme-system><i class=icon></i></button></ul></details><li id=feed><details class=closable><summary class=circle title=Feed><i class=icon></i></summary> <ul><li><a href=https://karldyson.github.io/karld-blog-website/atom.xml>Atom</a><li><a href=https://karldyson.github.io/karld-blog-website/rss.xml>RSS</a></ul></details><li id=repo><a class=circle href=https://github.com/karldyson/karld-blog-website title=Repository> <i class=icon></i> </a></ul></nav><div id=search-container><label class=visually-hidden for=search-bar>Search</label><input placeholder="Search for…" autocomplete=off disabled id=search-bar type=search><div id=search-results-container><div id=search-results></div></div></div></header><main id=main-content><article><div id=heading><p><small> <time datetime=" 2012-09-16T00:00:00+00:00">Published on September 16, 2012</time></small><h1>CurrentCost Electricity Monitoring</h1><p><small><span>3 minutes read</span><span> • </span></small><ul class=tags><li><a class=tag href=https://karldyson.github.io/karld-blog-website/tags/linux/>linux</a><li><a class=tag href=https://karldyson.github.io/karld-blog-website/tags/electricity/>electricity</a><li><a class=tag href=https://karldyson.github.io/karld-blog-website/tags/currentcost/>currentcost</a><li><a class=tag href=https://karldyson.github.io/karld-blog-website/tags/monitoring/>monitoring</a><li><a class=tag href=https://karldyson.github.io/karld-blog-website/tags/raspberry-pi/>raspberry-pi</a><li><a class=tag href=https://karldyson.github.io/karld-blog-website/tags/perl/>perl</a><li><a class=tag href=https://karldyson.github.io/karld-blog-website/tags/munin/>munin</a></ul></div><div id=buttons-container><details class=closable id=backlinks><summary title=Backlinks><i class=icon></i></summary> <div><strong class=title>Backlinks</strong><div><ul><li><a href=https://karldyson.github.io/karld-blog-website/posts/live-electricity-usage/>Live Electricity Usage</a></ul></div></div></details><a title="Go to Top" href=#top id=go-to-top><i class=icon></i></a><a href="https://shareopenly.org/share/?url=https://karldyson.github.io/karld-blog-website/posts/current-cost/&text=How%20to%20do%20cost%20effective%20electricity%20usage%20monitoring%20from%20CurrentCost%20devices" id=share title=Share><i class=icon></i></a><a title="File an Issue" href=https://github.com/karldyson/karld-blog-website/issues id=issue><i class=icon></i></a></div><p>For a while now, I’ve been using a Current Cost CC128 to monitor my electricity usage.<p>I hacked together a munin plugin to monitor both the electricty usage, and as the unit is in my lounge and coughs up temperature, it also provides the temperature reading.<p>For a number of reasons, the munin plugin doesn’t read the device directly. Only one device can open the serial port at a time, and there were a couple of things I wanted to do with the data, so didn’t want them fighting. I had a small piece of code grab the XML once a minute and dump it in a file instead.<p>Talking to a friend recently, they quite rightly pointed out (reminding me) that this method takes an instantaneous value for both the temperature and the electricity usage.<p>Whilst not a problem for the former as it won’t vary greatly within the 5 minute polling periods, the electricity usage clearly will. Think about boiling a kettle; if you were (un)? lucky enough to time the kettle just right, you could be between polls and not record the increased usage at all.<p>So, I’ve modified the way in which I record the data and write the files for the various things including munin to use.<p>As you’ll probably be aware, the CC128 outputs it’s data once every 6 seconds, so there’s clearly more data to make use of than just the single reading every 5 minutes.<p>I have a small daemon written in perl that listens on the serial port and every time it gets a full string of XML, it records the data to a database. Rather than re-write the munin plugin at the moment, along with anything else that uses the data file, I have a small bit of perl that runs from cron each minute that populates the expected XML into the file using averages of the values collected in the preceding 5 minute period. You could, of course, make this 95th percentile or whatever tickles your fancy.<p>So, the SQL table looks like this:<pre class="language-sql z-code" data-lang=sql><code class=language-sql data-lang=sql><span class="z-source z-sql">mysql<span class="z-keyword z-operator z-comparison z-sql">></span> describe data;
</span><span class="z-source z-sql"><span class="z-keyword z-operator z-math z-sql">+</span><span class="z-comment z-line z-double-dash z-sql"><span class="z-punctuation z-definition z-comment z-sql">--</span>----------+------------------+------+-----+-------------------+-----------------------------+
</span></span><span class="z-source z-sql">| Field      | Type             | <span class="z-constant z-language z-sql">Null</span> | Key | <span class="z-storage z-modifier z-sql">Default</span>           | Extra                       |
</span><span class="z-source z-sql"><span class="z-keyword z-operator z-math z-sql">+</span><span class="z-comment z-line z-double-dash z-sql"><span class="z-punctuation z-definition z-comment z-sql">--</span>----------+------------------+------+-----+-------------------+-----------------------------+
</span></span><span class="z-source z-sql">| id         | <span class="z-storage z-type z-sql">int</span>(<span class="z-constant z-numeric z-sql">10</span>) unsigned | NO   | PRI | <span class="z-constant z-language z-sql">NULL</span>              | auto_increment              |
</span><span class="z-source z-sql">| dsb        | <span class="z-storage z-type z-sql">int</span>(<span class="z-constant z-numeric z-sql">10</span>) unsigned | YES  |     | <span class="z-constant z-language z-sql">NULL</span>              |                             |
</span><span class="z-source z-sql">| <span class="z-storage z-type z-sql">time</span>       | <span class="z-storage z-type z-sql">timestamp</span>        | NO   |     | <span class="z-support z-function z-scalar z-sql">CURRENT_TIMESTAMP</span> | <span class="z-storage z-modifier z-sql">on update</span> <span class="z-support z-function z-scalar z-sql">CURRENT_TIMESTAMP</span> |
</span><span class="z-source z-sql">| tmpr       | <span class="z-storage z-type z-sql">decimal</span>(<span class="z-constant z-numeric z-sql">6</span>,<span class="z-constant z-numeric z-sql">4</span>)     | YES  |     | <span class="z-constant z-language z-sql">NULL</span>              |                             |
</span><span class="z-source z-sql">| sensor     | <span class="z-storage z-type z-sql">int</span>(<span class="z-constant z-numeric z-sql">10</span>) unsigned | YES  |     | <span class="z-constant z-language z-sql">NULL</span>              |                             |
</span><span class="z-source z-sql">| unit_id    | <span class="z-storage z-type z-sql">int</span>(<span class="z-constant z-numeric z-sql">10</span>) unsigned | YES  |     | <span class="z-constant z-language z-sql">NULL</span>              |                             |
</span><span class="z-source z-sql">| type       | <span class="z-storage z-type z-sql">int</span>(<span class="z-constant z-numeric z-sql">10</span>) unsigned | YES  |     | <span class="z-constant z-language z-sql">NULL</span>              |                             |
</span><span class="z-source z-sql">| channel    | <span class="z-storage z-type z-sql">int</span>(<span class="z-constant z-numeric z-sql">10</span>) unsigned | YES  |     | <span class="z-constant z-language z-sql">NULL</span>              |                             |
</span><span class="z-source z-sql">| data_units | <span class="z-storage z-type z-sql">varchar</span>(<span class="z-constant z-numeric z-sql">128</span>)     | YES  |     | <span class="z-constant z-language z-sql">NULL</span>              |                             |
</span><span class="z-source z-sql">| data_value | <span class="z-storage z-type z-sql">int</span>(<span class="z-constant z-numeric z-sql">10</span>) unsigned | YES  |     | <span class="z-constant z-language z-sql">NULL</span>              |                             |
</span><span class="z-source z-sql"><span class="z-keyword z-operator z-math z-sql">+</span><span class="z-comment z-line z-double-dash z-sql"><span class="z-punctuation z-definition z-comment z-sql">--</span>----------+------------------+------+-----+-------------------+-----------------------------+
</span></span></code></pre><pre class="language-sql z-code" data-lang=sql><code class=language-sql data-lang=sql><span class="z-source z-sql"><span class="z-meta z-create z-sql"><span class="z-keyword z-other z-create z-sql">create or replace</span> <span class="z-keyword z-other z-sql">view</span> </span><span class="z-meta z-toc-list z-full-identifier z-sql">averages </span><span class="z-meta z-toc-list z-full-identifier z-sql"><span class="z-entity z-name z-function z-sql">as</span></span>
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">select</span> sensor,dsb,unit_id,type,channel,data_units,<span class="z-support z-function z-aggregate z-sql">avg</span>(tmpr) <span class="z-keyword z-operator z-assignment z-alias z-sql">as</span> tmpr,<span class="z-support z-function z-aggregate z-sql">avg</span>(data_value) <span class="z-keyword z-operator z-assignment z-alias z-sql">as</span> value,now<span class="z-meta z-block z-sql"><span class="z-punctuation z-section z-scope z-begin z-sql">(</span><span class="z-punctuation z-section z-scope z-end z-sql">)</span></span> <span class="z-keyword z-operator z-assignment z-alias z-sql">as</span> now,
</span><span class="z-source z-sql">from_unixtime(<span class="z-constant z-numeric z-sql">300</span> <span class="z-variable z-language z-star z-sql">*</span> floor(unix_timestamp<span class="z-meta z-block z-sql"><span class="z-punctuation z-section z-scope z-begin z-sql">(</span><span class="z-punctuation z-section z-scope z-end z-sql">)</span></span><span class="z-keyword z-operator z-math z-sql">/</span><span class="z-constant z-numeric z-sql">300</span>)<span class="z-keyword z-operator z-math z-sql">-</span><span class="z-constant z-numeric z-sql">300</span>) <span class="z-keyword z-operator z-assignment z-alias z-sql">as</span> start,from_unixtime(<span class="z-constant z-numeric z-sql">300</span> <span class="z-variable z-language z-star z-sql">*</span> floor(unix_timestamp<span class="z-meta z-block z-sql"><span class="z-punctuation z-section z-scope z-begin z-sql">(</span><span class="z-punctuation z-section z-scope z-end z-sql">)</span></span><span class="z-keyword z-operator z-math z-sql">/</span><span class="z-constant z-numeric z-sql">300</span>)) <span class="z-keyword z-operator z-assignment z-alias z-sql">as</span> <span class="z-keyword z-other z-DML z-sql">end</span> 
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">from</span> data 
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">where</span> <span class="z-storage z-type z-sql">time</span> <span class="z-keyword z-operator z-logical z-sql">between</span> from_unixtime(<span class="z-constant z-numeric z-sql">300</span> <span class="z-variable z-language z-star z-sql">*</span> floor(unix_timestamp<span class="z-meta z-block z-sql"><span class="z-punctuation z-section z-scope z-begin z-sql">(</span><span class="z-punctuation z-section z-scope z-end z-sql">)</span></span><span class="z-keyword z-operator z-math z-sql">/</span><span class="z-constant z-numeric z-sql">300</span>)<span class="z-keyword z-operator z-math z-sql">-</span><span class="z-constant z-numeric z-sql">300</span>) <span class="z-keyword z-operator z-logical z-sql">and</span> from_unixtime(<span class="z-constant z-numeric z-sql">300</span> <span class="z-variable z-language z-star z-sql">*</span> floor(unix_timestamp<span class="z-meta z-block z-sql"><span class="z-punctuation z-section z-scope z-begin z-sql">(</span><span class="z-punctuation z-section z-scope z-end z-sql">)</span></span><span class="z-keyword z-operator z-math z-sql">/</span><span class="z-constant z-numeric z-sql">300</span>)) 
</span><span class="z-source z-sql"><span class="z-keyword z-other z-DML z-sql">group by</span> unit_id,sensor,channel;
</span></code></pre><p>I should credit <a href=http://larig.wordpress.com/2012/02/08/time-rounded-to-five-minutes-in-mysql/>http://larig.wordpress.com/2012/02/08/time-rounded-to-five-minutes-in-mysql/</a> for the sql to round time to the current 5 minute window.<p>The bit that writes the XML file looks like this:<pre class="language-perl z-code" data-lang=perl><code class=language-perl data-lang=perl><span class="z-source z-perl"><span class="z-meta z-comment z-perl"><span class="z-comment z-line z-number-sign z-perl"><span class="z-punctuation z-definition z-comment z-perl">#</span>!/usr/bin/perl
</span></span></span><span class="z-source z-perl">
</span><span class="z-source z-perl"><span class="z-meta z-preprocessor z-use z-perl"><span class="z-keyword z-control z-import z-use z-perl">use</span> <span class="z-entity z-name z-namespace z-perl">strict</span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">
</span><span class="z-source z-perl"><span class="z-meta z-preprocessor z-use z-perl"><span class="z-keyword z-control z-import z-use z-perl">use</span> <span class="z-entity z-name z-namespace z-perl">DBI</span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">
</span><span class="z-source z-perl"><span class="z-storage z-type z-variable z-perl">my</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>dsn</span> <span class="z-keyword z-operator z-assignment z-perl">=</span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>DBI:mysql:database=&lt;removed>;host=&lt;removed>;port=3306<span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl"><span class="z-storage z-type z-variable z-perl">my</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>dbh</span> <span class="z-keyword z-operator z-assignment z-perl">=</span> <span class="z-variable z-namespace z-perl">DBI</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-function-call z-perl"><span class="z-variable z-function z-member z-perl">connect</span></span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>dsn</span><span class="z-punctuation z-separator z-sequence z-perl">,</span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-single z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">'</span>&lt;removed><span class="z-punctuation z-definition z-string z-end z-perl">'</span></span></span><span class="z-punctuation z-separator z-sequence z-perl">,</span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-single z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">'</span>&lt;removed><span class="z-punctuation z-definition z-string z-end z-perl">'</span></span></span><span class="z-punctuation z-section z-group z-end z-perl">)</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">
</span><span class="z-source z-perl"><span class="z-storage z-type z-variable z-perl">my</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>sql</span> <span class="z-keyword z-operator z-assignment z-perl">=</span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-single z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">'</span>select * from averages<span class="z-punctuation z-definition z-string z-end z-perl">'</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">
</span><span class="z-source z-perl"><span class="z-storage z-type z-variable z-perl">my</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>sth</span> <span class="z-keyword z-operator z-assignment z-perl">=</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>dbh</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-function-call z-perl"><span class="z-variable z-function z-member z-perl">prepare</span></span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>sql</span><span class="z-punctuation z-section z-group z-end z-perl">)</span> <span class="z-keyword z-operator z-logical z-perl">||</span> <span class="z-keyword z-control z-flow z-die z-perl">die</span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>cannot prepare sql<span class="z-constant z-character z-escape z-perl">\n</span></span><span class="z-meta z-interpolation z-perl"><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>sql</span></span><span class="z-string z-quoted z-double z-perl"><span class="z-constant z-character z-escape z-perl">\n</span></span><span class="z-meta z-interpolation z-perl"><span class="z-meta z-path z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span><span class="z-variable z-namespace z-perl">DBI</span><span class="z-punctuation z-accessor z-double-colon z-perl">::</span><span class="z-variable z-other z-readwrite z-perl">errstr</span></span></span><span class="z-string z-quoted z-double z-perl"><span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">
</span><span class="z-source z-perl"><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>sth</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-function-call z-perl"><span class="z-variable z-function z-member z-perl">execute</span></span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-punctuation z-section z-group z-end z-perl">)</span> <span class="z-keyword z-operator z-logical z-perl">||</span> <span class="z-keyword z-control z-flow z-die z-perl">die</span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>cannot execute sql<span class="z-constant z-character z-escape z-perl">\n</span></span><span class="z-meta z-interpolation z-perl"><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>sql</span></span><span class="z-string z-quoted z-double z-perl"><span class="z-constant z-character z-escape z-perl">\n</span></span><span class="z-meta z-interpolation z-perl"><span class="z-meta z-path z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span><span class="z-variable z-namespace z-perl">DBI</span><span class="z-punctuation z-accessor z-double-colon z-perl">::</span><span class="z-variable z-other z-readwrite z-perl">errstr</span></span></span><span class="z-string z-quoted z-double z-perl"><span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">
</span><span class="z-source z-perl"><span class="z-keyword z-control z-conditional z-if z-perl">if</span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>sth</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-function-call z-perl"><span class="z-variable z-function z-member z-perl">rows</span></span> <span class="z-keyword z-operator z-comparison z-perl">></span> <span class="z-constant z-numeric z-integer z-decimal z-perl">0</span><span class="z-punctuation z-section z-group z-end z-perl">)</span> <span class="z-punctuation z-section z-block z-begin z-perl">{</span>
</span><span class="z-source z-perl">	<span class="z-storage z-type z-variable z-perl">my</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>r</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">	<span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">print</span></span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>&lt;msg><span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">	<span class="z-keyword z-control z-loop z-while z-perl">while</span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-storage z-type z-variable z-perl">my</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>row</span> <span class="z-keyword z-operator z-assignment z-perl">=</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>sth</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-function-call z-perl"><span class="z-variable z-function z-member z-perl">fetchrow_hashref</span></span><span class="z-punctuation z-section z-group z-end z-perl">)</span> <span class="z-punctuation z-section z-block z-begin z-perl">{</span>
</span><span class="z-source z-perl">		<span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">print</span></span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>  &lt;ch</span><span class="z-meta z-interpolation z-perl"><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>row</span></span><span class="z-string z-quoted z-double z-perl">->{channel}><span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">		<span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">print</span></span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>    &lt;</span><span class="z-meta z-interpolation z-perl"><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>row</span></span><span class="z-string z-quoted z-double z-perl">->{data_units}></span><span class="z-meta z-interpolation z-perl"><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>row</span></span><span class="z-string z-quoted z-double z-perl">->{value}&lt;/</span><span class="z-meta z-interpolation z-perl"><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>row</span></span><span class="z-string z-quoted z-double z-perl">->{data_units}><span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">		<span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">print</span></span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>  &lt;/ch</span><span class="z-meta z-interpolation z-perl"><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>row</span></span><span class="z-string z-quoted z-double z-perl">->{channel}><span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">		<span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>r</span> <span class="z-keyword z-operator z-assignment z-perl">=</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>row</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">	<span class="z-punctuation z-section z-block z-end z-perl">}</span>
</span><span class="z-source z-perl">	<span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">print</span></span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>  &lt;sensor></span><span class="z-meta z-interpolation z-perl"><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>r</span></span><span class="z-string z-quoted z-double z-perl">->{sensor}&lt;/sensor><span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">	<span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">print</span></span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>  &lt;id></span><span class="z-meta z-interpolation z-perl"><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>r</span></span><span class="z-string z-quoted z-double z-perl">->{unit_id}&lt;/id><span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">	<span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">print</span></span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>  &lt;dsb></span><span class="z-meta z-interpolation z-perl"><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>r</span></span><span class="z-string z-quoted z-double z-perl">->{dsb}&lt;/dsb><span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">	<span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">print</span></span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>  &lt;tmpr></span><span class="z-meta z-interpolation z-perl"><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>r</span></span><span class="z-string z-quoted z-double z-perl">->{tmpr}&lt;/tmpr><span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">	<span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">print</span></span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>  &lt;type></span><span class="z-meta z-interpolation z-perl"><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>r</span></span><span class="z-string z-quoted z-double z-perl">->{type}&lt;/type><span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">	<span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">print</span></span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>  &lt;time></span><span class="z-meta z-interpolation z-perl"><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>r</span></span><span class="z-string z-quoted z-double z-perl">->{now}&lt;/time><span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">	<span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">print</span></span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>&lt;/msg><span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl"><span class="z-punctuation z-section z-block z-end z-perl">}</span> <span class="z-keyword z-control z-conditional z-else z-perl">else</span> <span class="z-punctuation z-section z-block z-begin z-perl">{</span>
</span><span class="z-source z-perl">	<span class="z-keyword z-control z-flow z-die z-perl">die</span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>no rows returned!<span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl"><span class="z-punctuation z-section z-block z-end z-perl">}</span>
</span><span class="z-source z-perl">
</span><span class="z-source z-perl"><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>sth</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-function-call z-perl"><span class="z-variable z-function z-member z-perl">finish</span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl"><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>dbh</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-function-call z-perl"><span class="z-variable z-function z-member z-perl">disconnect</span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span></code></pre><p>…and lastly, the bit that grabs the stuff and chucks it into the database looks like this (and also writes a backward compatible version of the XML file with the instantaneous values…:<pre class="language-perl z-code" data-lang=perl><code class=language-perl data-lang=perl><span class="z-source z-perl"><span class="z-meta z-comment z-perl"><span class="z-comment z-line z-number-sign z-perl"><span class="z-punctuation z-definition z-comment z-perl">#</span>!/usr/bin/perl
</span></span></span><span class="z-source z-perl">
</span><span class="z-source z-perl"><span class="z-variable z-language z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>|</span><span class="z-keyword z-operator z-arithmetic z-perl">++</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">
</span><span class="z-source z-perl"><span class="z-meta z-preprocessor z-use z-perl"><span class="z-keyword z-control z-import z-use z-perl">use</span> <span class="z-entity z-name z-namespace z-perl">strict</span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">
</span><span class="z-source z-perl"><span class="z-meta z-preprocessor z-use z-perl"><span class="z-keyword z-control z-import z-use z-perl">use</span> <span class="z-meta z-path z-perl"><span class="z-entity z-name z-namespace z-perl">File</span><span class="z-punctuation z-accessor z-double-colon z-perl">::</span><span class="z-entity z-name z-namespace z-perl">Copy</span></span> <span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">qw</span><span class="z-meta z-generic z-perl"><span class="z-punctuation z-section z-generic z-begin z-perl">/</span></span><span class="z-meta z-generic z-perl"><span class="z-meta z-string z-perl"><span class="z-string z-unquoted z-perl">move</span></span><span class="z-punctuation z-section z-generic z-end z-perl">/</span></span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl"><span class="z-meta z-preprocessor z-use z-perl"><span class="z-keyword z-control z-import z-use z-perl">use</span> <span class="z-meta z-path z-perl"><span class="z-entity z-name z-namespace z-perl">Device</span><span class="z-punctuation z-accessor z-double-colon z-perl">::</span><span class="z-entity z-name z-namespace z-perl">SerialPort</span></span> <span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">qw</span><span class="z-meta z-generic z-perl"><span class="z-punctuation z-section z-generic z-begin z-perl">/</span></span><span class="z-meta z-generic z-perl"><span class="z-meta z-string z-perl"><span class="z-string z-unquoted z-perl">:PARAM :STAT 0.07</span></span><span class="z-punctuation z-section z-generic z-end z-perl">/</span></span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl"><span class="z-meta z-preprocessor z-use z-perl"><span class="z-keyword z-control z-import z-use z-perl">use</span> <span class="z-meta z-path z-perl"><span class="z-entity z-name z-namespace z-perl">XML</span><span class="z-punctuation z-accessor z-double-colon z-perl">::</span><span class="z-entity z-name z-namespace z-perl">Simple</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl"><span class="z-meta z-preprocessor z-use z-perl"><span class="z-keyword z-control z-import z-use z-perl">use</span> <span class="z-entity z-name z-namespace z-perl">DBI</span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl"><span class="z-meta z-preprocessor z-use z-perl"><span class="z-keyword z-control z-import z-use z-perl">use</span> <span class="z-meta z-path z-perl"><span class="z-entity z-name z-namespace z-perl">Data</span><span class="z-punctuation z-accessor z-double-colon z-perl">::</span><span class="z-entity z-name z-namespace z-perl">Dumper</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">
</span><span class="z-source z-perl"><span class="z-storage z-type z-variable z-perl">my</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>debug</span> <span class="z-keyword z-operator z-assignment z-perl">=</span> <span class="z-variable z-language z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>ENV</span><span class="z-meta z-item-access z-perl"><span class="z-punctuation z-section z-item-access z-begin z-perl">{</span><span class="z-constant z-other z-key z-perl">DEBUG</span><span class="z-punctuation z-section z-item-access z-end z-perl">}</span></span> <span class="z-keyword z-operator z-logical z-perl">||</span> <span class="z-constant z-numeric z-integer z-decimal z-perl">0</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">
</span><span class="z-source z-perl"><span class="z-meta z-preprocessor z-use z-perl"><span class="z-keyword z-control z-import z-use z-perl">use</span> <span class="z-meta z-path z-perl"><span class="z-entity z-name z-namespace z-perl">Proc</span><span class="z-punctuation z-accessor z-double-colon z-perl">::</span><span class="z-entity z-name z-namespace z-perl">PID</span><span class="z-punctuation z-accessor z-double-colon z-perl">::</span><span class="z-entity z-name z-namespace z-perl">File</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl"><span class="z-keyword z-control z-conditional z-if z-perl">if</span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-meta z-path z-perl"><span class="z-variable z-namespace z-perl">Proc</span><span class="z-punctuation z-accessor z-double-colon z-perl">::</span><span class="z-variable z-namespace z-perl">PID</span><span class="z-punctuation z-accessor z-double-colon z-perl">::</span><span class="z-variable z-namespace z-perl">File</span></span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-function-call z-perl"><span class="z-variable z-function z-member z-perl">running</span></span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-punctuation z-section z-group z-end z-perl">)</span><span class="z-punctuation z-section z-group z-end z-perl">)</span> <span class="z-punctuation z-section z-block z-begin z-perl">{</span>
</span><span class="z-source z-perl">	<span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">print</span></span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>Already running<span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span> <span class="z-keyword z-control z-conditional z-if z-perl">if</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>debug</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">	<span class="z-keyword z-control z-flow z-exit z-perl">exit</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl"><span class="z-punctuation z-section z-block z-end z-perl">}</span>
</span><span class="z-source z-perl">
</span><span class="z-source z-perl"><span class="z-storage z-type z-variable z-perl">my</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>port</span> <span class="z-keyword z-operator z-assignment z-perl">=</span> <span class="z-variable z-language z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>ENV</span><span class="z-meta z-item-access z-perl"><span class="z-punctuation z-section z-item-access z-begin z-perl">{</span><span class="z-constant z-other z-key z-perl">port</span><span class="z-punctuation z-section z-item-access z-end z-perl">}</span></span> <span class="z-keyword z-operator z-logical z-perl">||</span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-single z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">'</span>/dev/ttyUSB0<span class="z-punctuation z-definition z-string z-end z-perl">'</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl"><span class="z-storage z-type z-variable z-perl">my</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>baud</span> <span class="z-keyword z-operator z-assignment z-perl">=</span> <span class="z-variable z-language z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>ENV</span><span class="z-meta z-item-access z-perl"><span class="z-punctuation z-section z-item-access z-begin z-perl">{</span><span class="z-constant z-other z-key z-perl">baud</span><span class="z-punctuation z-section z-item-access z-end z-perl">}</span></span> <span class="z-keyword z-operator z-logical z-perl">||</span> <span class="z-constant z-numeric z-integer z-decimal z-perl">57600</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">
</span><span class="z-source z-perl"><span class="z-storage z-type z-variable z-perl">my</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>debug</span> <span class="z-keyword z-operator z-assignment z-perl">=</span> <span class="z-variable z-language z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>ENV</span><span class="z-meta z-item-access z-perl"><span class="z-punctuation z-section z-item-access z-begin z-perl">{</span><span class="z-constant z-other z-key z-perl">DEBUG</span><span class="z-punctuation z-section z-item-access z-end z-perl">}</span></span> <span class="z-keyword z-operator z-logical z-perl">||</span> <span class="z-constant z-numeric z-integer z-decimal z-perl">0</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">
</span><span class="z-source z-perl"><span class="z-storage z-type z-variable z-perl">my</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>cc</span> <span class="z-keyword z-operator z-assignment z-perl">=</span> <span class="z-meta z-path z-perl"><span class="z-variable z-namespace z-perl">Device</span><span class="z-punctuation z-accessor z-double-colon z-perl">::</span><span class="z-variable z-namespace z-perl">SerialPort</span></span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-function-call z-perl"><span class="z-variable z-function z-member z-perl">new</span></span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>port</span><span class="z-punctuation z-section z-group z-end z-perl">)</span> <span class="z-keyword z-operator z-logical z-perl">||</span> <span class="z-keyword z-control z-flow z-die z-perl">die</span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>unable to open port: </span><span class="z-meta z-interpolation z-perl"><span class="z-variable z-language z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>!</span></span><span class="z-string z-quoted z-double z-perl"><span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl"><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>cc</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-function-call z-perl"><span class="z-variable z-function z-member z-perl">baudrate</span></span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>baud</span><span class="z-punctuation z-section z-group z-end z-perl">)</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl"><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>cc</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-function-call z-perl"><span class="z-variable z-function z-member z-perl">read_char_time</span></span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-constant z-numeric z-integer z-decimal z-perl">0</span><span class="z-punctuation z-section z-group z-end z-perl">)</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl"><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>cc</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-function-call z-perl"><span class="z-variable z-function z-member z-perl">read_const_time</span></span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-constant z-numeric z-integer z-decimal z-perl">1000</span><span class="z-punctuation z-section z-group z-end z-perl">)</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl"><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>cc</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-function-call z-perl"><span class="z-variable z-function z-member z-perl">write_settings</span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">
</span><span class="z-source z-perl"><span class="z-storage z-type z-variable z-perl">my</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>dsn</span> <span class="z-keyword z-operator z-assignment z-perl">=</span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>DBI:mysql:database=&lt;removed>;host=&lt;removed>;port=3306<span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl"><span class="z-storage z-type z-variable z-perl">my</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>dbh</span> <span class="z-keyword z-operator z-assignment z-perl">=</span> <span class="z-variable z-namespace z-perl">DBI</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-function-call z-perl"><span class="z-variable z-function z-member z-perl">connect</span></span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>dsn</span><span class="z-punctuation z-separator z-sequence z-perl">,</span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-single z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">'</span>&lt;removed><span class="z-punctuation z-definition z-string z-end z-perl">'</span></span></span><span class="z-punctuation z-separator z-sequence z-perl">,</span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-single z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">'</span>&lt;removed><span class="z-punctuation z-definition z-string z-end z-perl">'</span></span></span><span class="z-punctuation z-section z-group z-end z-perl">)</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl"><span class="z-storage z-type z-variable z-perl">my</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>sql</span> <span class="z-keyword z-operator z-assignment z-perl">=</span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-single z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">'</span>insert into data (dsb,tmpr,sensor,unit_id,type,channel,data_units,data_value) values (?,?,?,?,?,?,?,?)<span class="z-punctuation z-definition z-string z-end z-perl">'</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl"><span class="z-storage z-type z-variable z-perl">my</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>sth</span> <span class="z-keyword z-operator z-assignment z-perl">=</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>dbh</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-function-call z-perl"><span class="z-variable z-function z-member z-perl">prepare</span></span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>sql</span><span class="z-punctuation z-section z-group z-end z-perl">)</span> <span class="z-keyword z-operator z-logical z-perl">||</span> <span class="z-keyword z-control z-flow z-die z-perl">die</span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>cannot prepare sql<span class="z-constant z-character z-escape z-perl">\n</span></span><span class="z-meta z-interpolation z-perl"><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>sql</span></span><span class="z-string z-quoted z-double z-perl"><span class="z-constant z-character z-escape z-perl">\n</span></span><span class="z-meta z-interpolation z-perl"><span class="z-meta z-path z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span><span class="z-variable z-namespace z-perl">DBI</span><span class="z-punctuation z-accessor z-double-colon z-perl">::</span><span class="z-variable z-other z-readwrite z-perl">errstr</span></span></span><span class="z-string z-quoted z-double z-perl"><span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">
</span><span class="z-source z-perl"><span class="z-keyword z-control z-loop z-while z-perl">while</span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-constant z-numeric z-integer z-decimal z-perl">1</span><span class="z-punctuation z-section z-group z-end z-perl">)</span> <span class="z-punctuation z-section z-block z-begin z-perl">{</span>
</span><span class="z-source z-perl">	<span class="z-storage z-type z-variable z-perl">my</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>timeout</span> <span class="z-keyword z-operator z-assignment z-perl">=</span> <span class="z-constant z-numeric z-integer z-decimal z-perl">10</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">	<span class="z-storage z-type z-variable z-perl">my</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>chars</span> <span class="z-keyword z-operator z-assignment z-perl">=</span> <span class="z-constant z-numeric z-integer z-decimal z-perl">0</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">	<span class="z-storage z-type z-variable z-perl">my</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>buffer</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">	<span class="z-entity z-name z-label z-perl">LOOP</span><span class="z-punctuation z-separator z-perl">:</span> <span class="z-keyword z-control z-loop z-while z-perl">while</span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>timeout</span> <span class="z-keyword z-operator z-comparison z-perl">></span> <span class="z-constant z-numeric z-integer z-decimal z-perl">0</span><span class="z-punctuation z-section z-group z-end z-perl">)</span> <span class="z-punctuation z-section z-block z-begin z-perl">{</span>
</span><span class="z-source z-perl">		<span class="z-storage z-type z-variable z-perl">my</span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>count</span><span class="z-punctuation z-separator z-sequence z-perl">,</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>saw</span><span class="z-punctuation z-section z-group z-end z-perl">)</span> <span class="z-keyword z-operator z-assignment z-perl">=</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>cc</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-function-call z-perl"><span class="z-variable z-function z-member z-perl">read</span></span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-constant z-numeric z-integer z-decimal z-perl">255</span><span class="z-punctuation z-section z-group z-end z-perl">)</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">		<span class="z-keyword z-control z-conditional z-if z-perl">if</span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>count</span> <span class="z-keyword z-operator z-comparison z-perl">></span> <span class="z-constant z-numeric z-integer z-decimal z-perl">0</span><span class="z-punctuation z-section z-group z-end z-perl">)</span> <span class="z-punctuation z-section z-block z-begin z-perl">{</span>
</span><span class="z-source z-perl">			<span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>chars</span> <span class="z-keyword z-operator z-assignment z-perl">+=</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>count</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">			<span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>buffer</span> <span class="z-keyword z-operator z-concat z-perl">.=</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>saw</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">			<span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">chomp</span></span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>buffer</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">			<span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">print</span></span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>added<span class="z-constant z-character z-escape z-perl">\n</span></span><span class="z-meta z-interpolation z-perl"><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>saw</span></span><span class="z-string z-quoted z-double z-perl"><span class="z-constant z-character z-escape z-perl">\n</span>now have<span class="z-constant z-character z-escape z-perl">\n</span></span><span class="z-meta z-interpolation z-perl"><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>buffer</span></span><span class="z-string z-quoted z-double z-perl"><span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span> <span class="z-keyword z-control z-conditional z-if z-perl">if</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>debug</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">			<span class="z-keyword z-control z-conditional z-if z-perl">if</span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>buffer</span> <span class="z-keyword z-operator z-binary z-perl">=~</span> <span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">m</span><span class="z-punctuation z-section z-generic z-begin z-perl">|</span></span><span class="z-meta z-function-call z-perl"><span class="z-meta z-string z-perl"><span class="z-string z-regexp z-perl"><span class="z-source z-regexp"><span class="z-meta z-literal z-regexp">&lt;</span><span class="z-meta z-literal z-regexp">m</span><span class="z-meta z-literal z-regexp">s</span><span class="z-meta z-literal z-regexp">g</span><span class="z-meta z-literal z-regexp">></span><span class="z-keyword z-other z-any z-regexp">.</span><span class="z-keyword z-operator z-quantifier z-regexp">*?</span><span class="z-meta z-literal z-regexp">&lt;</span><span class="z-meta z-literal z-regexp">/</span><span class="z-meta z-literal z-regexp">m</span><span class="z-meta z-literal z-regexp">s</span><span class="z-meta z-literal z-regexp">g</span><span class="z-meta z-literal z-regexp">></span></span></span></span></span><span class="z-meta z-function-call z-perl"><span class="z-punctuation z-section z-generic z-end z-perl">|</span></span><span class="z-punctuation z-section z-group z-end z-perl">)</span> <span class="z-punctuation z-section z-block z-begin z-perl">{</span>
</span><span class="z-source z-perl">				<span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">print</span></span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>Buffer contains XML<span class="z-constant z-character z-escape z-perl">\n</span><span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span> <span class="z-keyword z-control z-conditional z-if z-perl">if</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>debug</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">				<span class="z-meta z-function-call z-perl"><span class="z-variable z-function z-perl">do_xml</span></span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>buffer</span><span class="z-punctuation z-section z-group z-end z-perl">)</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">				<span class="z-keyword z-control z-flow z-last z-perl">last</span> <span class="z-variable z-label z-perl">LOOP</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">			<span class="z-punctuation z-section z-block z-end z-perl">}</span>
</span><span class="z-source z-perl">			<span class="z-keyword z-control z-conditional z-elseif z-perl">elsif</span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>buffer</span> <span class="z-keyword z-operator z-binary z-perl">=~</span> <span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">m</span><span class="z-punctuation z-section z-generic z-begin z-perl">|</span></span><span class="z-meta z-function-call z-perl"><span class="z-meta z-string z-perl"><span class="z-string z-regexp z-perl"><span class="z-source z-regexp"><span class="z-meta z-literal z-regexp">&lt;</span><span class="z-meta z-literal z-regexp">/</span><span class="z-meta z-literal z-regexp">m</span><span class="z-meta z-literal z-regexp">s</span><span class="z-meta z-literal z-regexp">g</span><span class="z-meta z-literal z-regexp">></span></span></span></span></span><span class="z-meta z-function-call z-perl"><span class="z-punctuation z-section z-generic z-end z-perl">|</span></span><span class="z-punctuation z-section z-group z-end z-perl">)</span> <span class="z-punctuation z-section z-block z-begin z-perl">{</span>
</span><span class="z-source z-perl">				<span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">print</span></span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>Caught the end of the XML<span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span> <span class="z-keyword z-control z-conditional z-if z-perl">if</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>debug</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">				<span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">undef</span></span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>buffer</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">			<span class="z-punctuation z-section z-block z-end z-perl">}</span>
</span><span class="z-source z-perl">		<span class="z-punctuation z-section z-block z-end z-perl">}</span> <span class="z-keyword z-control z-conditional z-else z-perl">else</span> <span class="z-punctuation z-section z-block z-begin z-perl">{</span>
</span><span class="z-source z-perl">			<span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">print</span></span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>.<span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span> <span class="z-keyword z-control z-conditional z-if z-perl">if</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>debug</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">			<span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>timeout</span><span class="z-keyword z-operator z-arithmetic z-perl">--</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">		<span class="z-punctuation z-section z-block z-end z-perl">}</span>
</span><span class="z-source z-perl">	
</span><span class="z-source z-perl">		<span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">print</span></span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>Waited </span><span class="z-meta z-interpolation z-perl"><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>timeout</span></span><span class="z-string z-quoted z-double z-perl"> and never saw what I was looking for<span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span> <span class="z-keyword z-control z-conditional z-if z-perl">if</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>timeout</span> <span class="z-keyword z-operator z-comparison z-perl">==</span> <span class="z-constant z-numeric z-integer z-decimal z-perl">0</span> <span class="z-keyword z-operator z-logical z-perl">&&</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>debug</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">	
</span><span class="z-source z-perl">	<span class="z-punctuation z-section z-block z-end z-perl">}</span>
</span><span class="z-source z-perl"><span class="z-punctuation z-section z-block z-end z-perl">}</span>
</span><span class="z-source z-perl">
</span><span class="z-source z-perl"><span class="z-meta z-function z-perl"><span class="z-storage z-type z-function z-perl"><span class="z-keyword z-declaration z-function z-perl">sub</span></span> <span class="z-entity z-name z-function z-perl">do_xml</span> </span><span class="z-punctuation z-section z-block z-begin z-perl">{</span>
</span><span class="z-source z-perl">	<span class="z-storage z-type z-variable z-perl">my</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>xmls</span> <span class="z-keyword z-operator z-assignment z-perl">=</span> <span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">shift</span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">	<span class="z-keyword z-control z-conditional z-if z-perl">if</span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>xmls</span> <span class="z-keyword z-operator z-binary z-perl">=~</span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>&lt;hist>.*?&lt;/hist><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span><span class="z-punctuation z-section z-group z-end z-perl">)</span> <span class="z-punctuation z-section z-block z-begin z-perl">{</span>
</span><span class="z-source z-perl">		<span class="z-keyword z-control z-flow z-return z-perl">return</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">	<span class="z-punctuation z-section z-block z-end z-perl">}</span> <span class="z-keyword z-control z-conditional z-else z-perl">else</span> <span class="z-punctuation z-section z-block z-begin z-perl">{</span>
</span><span class="z-source z-perl">		<span class="z-meta z-path z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span><span class="z-variable z-namespace z-perl">XML</span><span class="z-punctuation z-accessor z-double-colon z-perl">::</span><span class="z-variable z-namespace z-perl">Simple</span><span class="z-punctuation z-accessor z-double-colon z-perl">::</span><span class="z-variable z-other z-readwrite z-perl">PREFERRED_PARSER</span></span> <span class="z-keyword z-operator z-assignment z-perl">=</span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-single z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">'</span>XML::Parser<span class="z-punctuation z-definition z-string z-end z-perl">'</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">		<span class="z-storage z-type z-variable z-perl">my</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>xml</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">		<span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">eval</span></span> <span class="z-punctuation z-section z-block z-begin z-perl">{</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>xml</span> <span class="z-keyword z-operator z-assignment z-perl">=</span> <span class="z-meta z-function-call z-perl"><span class="z-variable z-function z-perl">XMLin</span></span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>xmls</span><span class="z-punctuation z-section z-group z-end z-perl">)</span><span class="z-punctuation z-terminator z-statement z-perl">;</span> <span class="z-punctuation z-section z-block z-end z-perl">}</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">		<span class="z-keyword z-control z-flow z-return z-perl">return</span> <span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">undef</span></span> <span class="z-keyword z-control z-conditional z-if z-perl">if</span> <span class="z-variable z-language z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>@</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">		<span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">print</span></span> <span class="z-meta z-function-call z-perl"><span class="z-variable z-function z-perl">Dumper</span></span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>xml</span><span class="z-punctuation z-section z-group z-end z-perl">)</span> <span class="z-keyword z-control z-conditional z-if z-perl">if</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>debug</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">		<span class="z-keyword z-control z-loop z-for z-perl">for</span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">keys</span></span> <span class="z-keyword z-operator z-dereference z-perl">%</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>xml</span><span class="z-punctuation z-section z-group z-end z-perl">)</span> <span class="z-punctuation z-section z-block z-begin z-perl">{</span>
</span><span class="z-source z-perl">			<span class="z-keyword z-control z-conditional z-if z-perl">if</span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">m</span><span class="z-punctuation z-section z-generic z-begin z-perl">/</span></span><span class="z-meta z-function-call z-perl"><span class="z-meta z-string z-perl"><span class="z-string z-regexp z-perl"><span class="z-source z-regexp"><span class="z-keyword z-control z-anchors z-regexp">^</span><span class="z-meta z-literal z-regexp">c</span><span class="z-meta z-literal z-regexp">h</span><span class="z-meta z-group z-regexp"><span class="z-keyword z-control z-group z-regexp">(</span></span><span class="z-meta z-group z-regexp"><span class="z-keyword z-control z-character-class z-regexp">\d</span><span class="z-keyword z-operator z-quantifier z-regexp">+</span></span><span class="z-meta z-group z-regexp"><span class="z-keyword z-control z-group z-regexp">)</span></span><span class="z-keyword z-control z-anchors z-regexp">$</span></span></span></span></span><span class="z-meta z-function-call z-perl"><span class="z-punctuation z-section z-generic z-end z-perl">/</span></span><span class="z-punctuation z-section z-group z-end z-perl">)</span> <span class="z-punctuation z-section z-block z-begin z-perl">{</span>
</span><span class="z-source z-perl">				<span class="z-storage z-type z-variable z-perl">my</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>channel</span> <span class="z-keyword z-operator z-assignment z-perl">=</span> <span class="z-variable z-language z-regexp z-match-group z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>1</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">				<span class="z-storage z-type z-variable z-perl">my</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>name</span> <span class="z-keyword z-operator z-assignment z-perl">=</span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-single z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">'</span>ch<span class="z-punctuation z-definition z-string z-end z-perl">'</span></span></span><span class="z-keyword z-operator z-concat z-perl">.</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>channel</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">				<span class="z-keyword z-control z-loop z-for z-perl">for</span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">keys</span></span> <span class="z-meta z-variable z-perl"><span class="z-keyword z-operator z-dereference z-perl">%</span><span class="z-punctuation z-definition z-variable z-begin z-perl">{</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>xml</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-item-access z-perl"><span class="z-punctuation z-section z-item-access z-begin z-perl">{</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>name</span><span class="z-punctuation z-section z-item-access z-end z-perl">}</span></span><span class="z-punctuation z-definition z-variable z-end z-perl">}</span></span><span class="z-punctuation z-section z-group z-end z-perl">)</span> <span class="z-punctuation z-section z-block z-begin z-perl">{</span>
</span><span class="z-source z-perl">					<span class="z-storage z-type z-variable z-perl">my</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>unit</span> <span class="z-keyword z-operator z-assignment z-perl">=</span> <span class="z-variable z-language z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>_</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">					<span class="z-storage z-type z-variable z-perl">my</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>value</span> <span class="z-keyword z-operator z-assignment z-perl">=</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>xml</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-item-access z-perl"><span class="z-punctuation z-section z-item-access z-begin z-perl">{</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>name</span><span class="z-punctuation z-section z-item-access z-end z-perl">}</span></span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-item-access z-perl"><span class="z-punctuation z-section z-item-access z-begin z-perl">{</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>unit</span><span class="z-punctuation z-section z-item-access z-end z-perl">}</span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">					<span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">printf</span></span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>dsb[<span class="z-constant z-other z-placeholder z-perl"><span class="z-punctuation z-definition z-placeholder z-perl">%</span>s</span>] tmpr[<span class="z-constant z-other z-placeholder z-perl"><span class="z-punctuation z-definition z-placeholder z-perl">%</span>s</span>] sensor[<span class="z-constant z-other z-placeholder z-perl"><span class="z-punctuation z-definition z-placeholder z-perl">%</span>s</span>] id[<span class="z-constant z-other z-placeholder z-perl"><span class="z-punctuation z-definition z-placeholder z-perl">%</span>s</span>] type[<span class="z-constant z-other z-placeholder z-perl"><span class="z-punctuation z-definition z-placeholder z-perl">%</span>s</span>] ch[<span class="z-constant z-other z-placeholder z-perl"><span class="z-punctuation z-definition z-placeholder z-perl">%</span>s</span>] units[<span class="z-constant z-other z-placeholder z-perl"><span class="z-punctuation z-definition z-placeholder z-perl">%</span>s</span>] val[<span class="z-constant z-other z-placeholder z-perl"><span class="z-punctuation z-definition z-placeholder z-perl">%</span>s</span>]<span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span><span class="z-punctuation z-separator z-sequence z-perl">,</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>xml</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-item-access z-perl"><span class="z-punctuation z-section z-item-access z-begin z-perl">{</span><span class="z-constant z-other z-key z-perl">dsb</span><span class="z-punctuation z-section z-item-access z-end z-perl">}</span></span><span class="z-punctuation z-separator z-sequence z-perl">,</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>xml</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-item-access z-perl"><span class="z-punctuation z-section z-item-access z-begin z-perl">{</span><span class="z-constant z-other z-key z-perl">tmpr</span><span class="z-punctuation z-section z-item-access z-end z-perl">}</span></span><span class="z-punctuation z-separator z-sequence z-perl">,</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>xml</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-item-access z-perl"><span class="z-punctuation z-section z-item-access z-begin z-perl">{</span><span class="z-constant z-other z-key z-perl">sensor</span><span class="z-punctuation z-section z-item-access z-end z-perl">}</span></span><span class="z-punctuation z-separator z-sequence z-perl">,</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>xml</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-item-access z-perl"><span class="z-punctuation z-section z-item-access z-begin z-perl">{</span><span class="z-constant z-other z-key z-perl">id</span><span class="z-punctuation z-section z-item-access z-end z-perl">}</span></span><span class="z-punctuation z-separator z-sequence z-perl">,</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>xml</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-item-access z-perl"><span class="z-punctuation z-section z-item-access z-begin z-perl">{</span><span class="z-constant z-other z-key z-perl">type</span><span class="z-punctuation z-section z-item-access z-end z-perl">}</span></span><span class="z-punctuation z-separator z-sequence z-perl">,</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>channel</span><span class="z-punctuation z-separator z-sequence z-perl">,</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>unit</span><span class="z-punctuation z-separator z-sequence z-perl">,</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>value</span><span class="z-punctuation z-section z-group z-end z-perl">)</span> <span class="z-keyword z-control z-conditional z-if z-perl">if</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>debug</span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">					<span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>sth</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-function-call z-perl"><span class="z-variable z-function z-member z-perl">execute</span></span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>xml</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-item-access z-perl"><span class="z-punctuation z-section z-item-access z-begin z-perl">{</span><span class="z-constant z-other z-key z-perl">dsb</span><span class="z-punctuation z-section z-item-access z-end z-perl">}</span></span><span class="z-punctuation z-separator z-sequence z-perl">,</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>xml</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-item-access z-perl"><span class="z-punctuation z-section z-item-access z-begin z-perl">{</span><span class="z-constant z-other z-key z-perl">tmpr</span><span class="z-punctuation z-section z-item-access z-end z-perl">}</span></span><span class="z-punctuation z-separator z-sequence z-perl">,</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>xml</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-item-access z-perl"><span class="z-punctuation z-section z-item-access z-begin z-perl">{</span><span class="z-constant z-other z-key z-perl">sensor</span><span class="z-punctuation z-section z-item-access z-end z-perl">}</span></span><span class="z-punctuation z-separator z-sequence z-perl">,</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>xml</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-item-access z-perl"><span class="z-punctuation z-section z-item-access z-begin z-perl">{</span><span class="z-constant z-other z-key z-perl">id</span><span class="z-punctuation z-section z-item-access z-end z-perl">}</span></span><span class="z-punctuation z-separator z-sequence z-perl">,</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>xml</span><span class="z-punctuation z-accessor z-arrow z-perl">-></span><span class="z-meta z-item-access z-perl"><span class="z-punctuation z-section z-item-access z-begin z-perl">{</span><span class="z-constant z-other z-key z-perl">type</span><span class="z-punctuation z-section z-item-access z-end z-perl">}</span></span><span class="z-punctuation z-separator z-sequence z-perl">,</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>channel</span><span class="z-punctuation z-separator z-sequence z-perl">,</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>unit</span><span class="z-punctuation z-separator z-sequence z-perl">,</span><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>value</span><span class="z-punctuation z-section z-group z-end z-perl">)</span> <span class="z-keyword z-operator z-logical z-perl">||</span> <span class="z-keyword z-control z-flow z-die z-perl">die</span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>cannot execute sql<span class="z-constant z-character z-escape z-perl">\n</span></span><span class="z-meta z-interpolation z-perl"><span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>sql</span></span><span class="z-string z-quoted z-double z-perl"><span class="z-constant z-character z-escape z-perl">\n</span></span><span class="z-meta z-interpolation z-perl"><span class="z-meta z-path z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span><span class="z-variable z-namespace z-perl">DBI</span><span class="z-punctuation z-accessor z-double-colon z-perl">::</span><span class="z-variable z-other z-readwrite z-perl">errstr</span></span></span><span class="z-string z-quoted z-double z-perl"><span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">				<span class="z-punctuation z-section z-block z-end z-perl">}</span>
</span><span class="z-source z-perl">			<span class="z-punctuation z-section z-block z-end z-perl">}</span>
</span><span class="z-source z-perl">		<span class="z-punctuation z-section z-block z-end z-perl">}</span>
</span><span class="z-source z-perl">		<span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">open</span></span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-constant z-other z-perl">XML</span><span class="z-punctuation z-separator z-sequence z-perl">,</span><span class="z-meta z-string z-perl"><span class="z-string z-quoted z-single z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">'</span>>/tmp/currentcost.snapshot.xml.tmp<span class="z-punctuation z-definition z-string z-end z-perl">'</span></span></span><span class="z-punctuation z-section z-group z-end z-perl">)</span> <span class="z-keyword z-operator z-logical z-perl">||</span> <span class="z-keyword z-control z-flow z-die z-perl">die</span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>cannot open file: </span><span class="z-meta z-interpolation z-perl"><span class="z-variable z-language z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>!</span></span><span class="z-string z-quoted z-double z-perl"><span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">		<span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">print</span></span> <span class="z-constant z-other z-perl">XML</span> <span class="z-variable z-other z-readwrite z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>xmls</span> <span class="z-keyword z-operator z-logical z-perl">||</span> <span class="z-keyword z-control z-flow z-die z-perl">die</span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>cannot write to file: </span><span class="z-meta z-interpolation z-perl"><span class="z-variable z-language z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>!</span></span><span class="z-string z-quoted z-double z-perl"><span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">		<span class="z-meta z-function-call z-perl"><span class="z-support z-function z-perl">close</span></span> <span class="z-constant z-other z-perl">XML</span> <span class="z-keyword z-operator z-logical z-perl">||</span> <span class="z-keyword z-control z-flow z-die z-perl">die</span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>cannot close file: </span><span class="z-meta z-interpolation z-perl"><span class="z-variable z-language z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>!</span></span><span class="z-string z-quoted z-double z-perl"><span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">		<span class="z-meta z-function-call z-perl"><span class="z-variable z-function z-perl">move</span></span><span class="z-punctuation z-section z-group z-begin z-perl">(</span><span class="z-meta z-string z-perl"><span class="z-string z-quoted z-single z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">'</span>/tmp/currentcost.snapshot.xml.tmp<span class="z-punctuation z-definition z-string z-end z-perl">'</span></span></span><span class="z-punctuation z-separator z-sequence z-perl">,</span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-single z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">'</span>/tmp/currentcost.snapshot.xml<span class="z-punctuation z-definition z-string z-end z-perl">'</span></span></span><span class="z-punctuation z-section z-group z-end z-perl">)</span> <span class="z-keyword z-operator z-logical z-perl">||</span> <span class="z-keyword z-control z-flow z-die z-perl">die</span> <span class="z-meta z-string z-perl"><span class="z-string z-quoted z-double z-perl"><span class="z-punctuation z-definition z-string z-begin z-perl">"</span>unable to move file: </span><span class="z-meta z-interpolation z-perl"><span class="z-variable z-language z-perl"><span class="z-punctuation z-definition z-variable z-perl">$</span>!</span></span><span class="z-string z-quoted z-double z-perl"><span class="z-constant z-character z-escape z-perl">\n</span><span class="z-punctuation z-definition z-string z-end z-perl">"</span></span></span><span class="z-punctuation z-terminator z-statement z-perl">;</span>
</span><span class="z-source z-perl">	<span class="z-punctuation z-section z-block z-end z-perl">}</span>
</span><span class="z-source z-perl"><span class="z-punctuation z-section z-block z-end z-perl">}</span>
</span></code></pre><p>I restart that from cron periodically, incase it dies. If it’s already running, it simply exits silently. It’s a quick hacky way to make it restart in the event something horrible happens. I did at least put the XML parse in an <code>eval</code> in case it barfs :-)<p>As usual, this blog post is as much for my personal notes of how I did it than anything else. Some of the code is awful, but it’s not life or death and so I’ve often been lazy with it. There’s no doubt this could be done prettier and less hacky if I had more time :-)</article><hr><nav id=post-nav><a class="post-nav-item post-nav-prev" href=https://karldyson.github.io/karld-blog-website/posts/temperature-monitoring/> <div class=nav-arrow>Previous</div> <span class=post-title>Cost Effective Temperature Monitoring</span> </a><a class="post-nav-item post-nav-next" href=https://karldyson.github.io/karld-blog-website/posts/watt4-live-black-horse/> <div class=nav-arrow>Next</div> <span class=post-title>Watt4 at The Black Horse</span> </a></nav><span class=hidden id=search-index>https://karldyson.github.io/karld-blog-website/search_index.en.json</span><span class=hidden id=more-matches-text>$MATCHES more matches</span></main><footer id=site-footer><nav><ul><li><a href=https://karldyson.github.io/karld-blog-website/about/>About</a><li><a href=https://karldyson.github.io/karld-blog-website/posts/>Posts</a><li><a href=https://karldyson.github.io/karld-blog-website/archive/>Archive</a><li><a href=https://karldyson.github.io/karld-blog-website/latest-posts/>Latest Posts</a></ul></nav><p>© Karl Dyson, 2010-2026. All rights reserved.<ul id=socials><li><a rel=" me" href=https://github.com/karldyson/ title=GitHub> <i style="--icon:url(&#34;data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EGitHub%3C/title%3E%3Cpath d='M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12'/%3E%3C/svg%3E&#34;)" class=icon></i> <span>GitHub</span> </a><li><a rel=" me" href=https://instagram.com/karlddyson/ title=Instagram> <i style="--icon:url(&#34;data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EInstagram%3C/title%3E%3Cpath d='M7.0301.084c-1.2768.0602-2.1487.264-2.911.5634-.7888.3075-1.4575.72-2.1228 1.3877-.6652.6677-1.075 1.3368-1.3802 2.127-.2954.7638-.4956 1.6365-.552 2.914-.0564 1.2775-.0689 1.6882-.0626 4.947.0062 3.2586.0206 3.6671.0825 4.9473.061 1.2765.264 2.1482.5635 2.9107.308.7889.72 1.4573 1.388 2.1228.6679.6655 1.3365 1.0743 2.1285 1.38.7632.295 1.6361.4961 2.9134.552 1.2773.056 1.6884.069 4.9462.0627 3.2578-.0062 3.668-.0207 4.9478-.0814 1.28-.0607 2.147-.2652 2.9098-.5633.7889-.3086 1.4578-.72 2.1228-1.3881.665-.6682 1.0745-1.3378 1.3795-2.1284.2957-.7632.4966-1.636.552-2.9124.056-1.2809.0692-1.6898.063-4.948-.0063-3.2583-.021-3.6668-.0817-4.9465-.0607-1.2797-.264-2.1487-.5633-2.9117-.3084-.7889-.72-1.4568-1.3876-2.1228C21.2982 1.33 20.628.9208 19.8378.6165 19.074.321 18.2017.1197 16.9244.0645 15.6471.0093 15.236-.005 11.977.0014 8.718.0076 8.31.0215 7.0301.0839m.1402 21.6932c-1.17-.0509-1.8053-.2453-2.2287-.408-.5606-.216-.96-.4771-1.3819-.895-.422-.4178-.6811-.8186-.9-1.378-.1644-.4234-.3624-1.058-.4171-2.228-.0595-1.2645-.072-1.6442-.079-4.848-.007-3.2037.0053-3.583.0607-4.848.05-1.169.2456-1.805.408-2.2282.216-.5613.4762-.96.895-1.3816.4188-.4217.8184-.6814 1.3783-.9003.423-.1651 1.0575-.3614 2.227-.4171 1.2655-.06 1.6447-.072 4.848-.079 3.2033-.007 3.5835.005 4.8495.0608 1.169.0508 1.8053.2445 2.228.408.5608.216.96.4754 1.3816.895.4217.4194.6816.8176.9005 1.3787.1653.4217.3617 1.056.4169 2.2263.0602 1.2655.0739 1.645.0796 4.848.0058 3.203-.0055 3.5834-.061 4.848-.051 1.17-.245 1.8055-.408 2.2294-.216.5604-.4763.96-.8954 1.3814-.419.4215-.8181.6811-1.3783.9-.4224.1649-1.0577.3617-2.2262.4174-1.2656.0595-1.6448.072-4.8493.079-3.2045.007-3.5825-.006-4.848-.0608M16.953 5.5864A1.44 1.44 0 1 0 18.39 4.144a1.44 1.44 0 0 0-1.437 1.4424M5.8385 12.012c.0067 3.4032 2.7706 6.1557 6.173 6.1493 3.4026-.0065 6.157-2.7701 6.1506-6.1733-.0065-3.4032-2.771-6.1565-6.174-6.1498-3.403.0067-6.156 2.771-6.1496 6.1738M8 12.0077a4 4 0 1 1 4.008 3.9921A3.9996 3.9996 0 0 1 8 12.0077'/%3E%3C/svg%3E&#34;)" class=icon></i> <span>Instagram</span> </a><li><a rel=" me" href=https://mastodon.social title=Mastodon> <i style="--icon:url(&#34;data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EMastodon%3C/title%3E%3Cpath d='M23.268 5.313c-.35-2.578-2.617-4.61-5.304-5.004C17.51.242 15.792 0 11.813 0h-.03c-3.98 0-4.835.242-5.288.309C3.882.692 1.496 2.518.917 5.127.64 6.412.61 7.837.661 9.143c.074 1.874.088 3.745.26 5.611.118 1.24.325 2.47.62 3.68.55 2.237 2.777 4.098 4.96 4.857 2.336.792 4.849.923 7.256.38.265-.061.527-.132.786-.213.585-.184 1.27-.39 1.774-.753a.057.057 0 0 0 .023-.043v-1.809a.052.052 0 0 0-.02-.041.053.053 0 0 0-.046-.01 20.282 20.282 0 0 1-4.709.545c-2.73 0-3.463-1.284-3.674-1.818a5.593 5.593 0 0 1-.319-1.433.053.053 0 0 1 .066-.054c1.517.363 3.072.546 4.632.546.376 0 .75 0 1.125-.01 1.57-.044 3.224-.124 4.768-.422.038-.008.077-.015.11-.024 2.435-.464 4.753-1.92 4.989-5.604.008-.145.03-1.52.03-1.67.002-.512.167-3.63-.024-5.545zm-3.748 9.195h-2.561V8.29c0-1.309-.55-1.976-1.67-1.976-1.23 0-1.846.79-1.846 2.35v3.403h-2.546V8.663c0-1.56-.617-2.35-1.848-2.35-1.112 0-1.668.668-1.67 1.977v6.218H4.822V8.102c0-1.31.337-2.35 1.011-3.12.696-.77 1.608-1.164 2.74-1.164 1.311 0 2.302.5 2.962 1.498l.638 1.06.638-1.06c.66-.999 1.65-1.498 2.96-1.498 1.13 0 2.043.395 2.74 1.164.675.77 1.012 1.81 1.012 3.12z'/%3E%3C/svg%3E&#34;)" class=icon></i> <span>Mastodon</span> </a></ul></footer>